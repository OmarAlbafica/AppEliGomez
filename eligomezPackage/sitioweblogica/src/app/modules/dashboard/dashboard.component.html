<div *ngIf="!isMobile" class="space-y-6">
  <!-- Header -->
  <div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
    <p class="text-gray-500 mt-2">Bienvenido al sistema de gestion de encomiendas</p>
  </div>

  <!-- Statistics Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
    <!-- Pedidos Hoy -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-blue-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Pedidos Hoy</p>
          <p class="text-3xl font-bold text-gray-900 mt-2">{{ stats.pedidosHoy }}</p>
        </div>
        <div class="text-4xl">ğŸ“¦</div>
      </div>
    </div>

    <!-- Pedidos MaÃ±ana -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-yellow-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Pedidos MaÃ±ana</p>
          <p class="text-3xl font-bold text-gray-900 mt-2">{{ stats.pedidosTomorrow }}</p>
        </div>
        <div class="text-4xl">ğŸ“…</div>
      </div>
    </div>

    <!-- Pedidos MiÃ©rcoles -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-purple-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Pedidos MiÃ©rcoles</p>
          <p class="text-3xl font-bold text-gray-900 mt-2">{{ stats.pedidosMiercoles }}</p>
        </div>
        <div class="text-4xl">ğŸ“‹</div>
      </div>
    </div>

    <!-- Pedidos SÃ¡bado -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-green-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Pedidos SÃ¡bado</p>
          <p class="text-3xl font-bold text-gray-900 mt-2">{{ stats.pedidosSabado }}</p>
        </div>
        <div class="text-4xl">ğŸ“…</div>
      </div>
    </div>

    <!-- Ingresos Hoy -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-green-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Ingresos Hoy</p>
          <p class="text-2xl font-bold text-gray-900 mt-2">{{ formatCurrency(stats.ingresoHoy) }}</p>
        </div>
        <div class="text-4xl">ğŸ’°</div>
      </div>
    </div>

    <!-- Ingresos Mes -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-purple-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Ingresos Mes</p>
          <p class="text-2xl font-bold text-gray-900 mt-2">{{ formatCurrency(stats.ingresoMes) }}</p>
        </div>
        <div class="text-4xl">ğŸ“ˆ</div>
      </div>
    </div>

    <!-- Ingresos MiÃ©rcoles -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-indigo-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Ingresos MiÃ©rcoles</p>
          <p class="text-2xl font-bold text-gray-900 mt-2">{{ formatCurrency(stats.ingresoMiercoles) }}</p>
        </div>
        <div class="text-4xl">ğŸ’µ</div>
      </div>
    </div>

    <!-- Ingresos SÃ¡bado -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-orange-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Ingresos SÃ¡bado</p>
          <p class="text-2xl font-bold text-gray-900 mt-2">{{ formatCurrency(stats.ingresoSabado) }}</p>
        </div>
        <div class="text-4xl">ğŸ’µ</div>
      </div>
    </div>

    <!-- Pendientes de Retirar -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-red-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Pendientes</p>
          <p class="text-3xl font-bold text-gray-900 mt-2">{{ stats.pedidosNoRetirados }}</p>
        </div>
        <div class="text-4xl">âš ï¸</div>
      </div>
    </div>

    <!-- Tasa Entrega -->
    <div class="bg-white rounded-lg shadow p-6 border-l-4 border-indigo-500">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-gray-500 text-sm">Tasa Entrega</p>
          <p class="text-3xl font-bold text-gray-900 mt-2">{{ stats.tasaEntrega }}%</p>
        </div>
        <div class="text-4xl">âœ…</div>
      </div>
    </div>
  </div>

  <!-- Retiros de Hoy -->
  <div class="bg-white rounded-lg shadow">
    <div class="p-6 border-b border-gray-200">
      <h2 class="text-xl font-bold text-gray-900">Retiros de Hoy</h2>
      <p class="text-sm text-gray-500 mt-1">{{ retiroHoy.length }} rutas programadas</p>
    </div>
    <div class="divide-y">
      <div *ngFor="let retiro of retiroHoy; let i = index" class="p-4">
        <div (click)="toggleRetiroHoy(i)" class="cursor-pointer flex items-center justify-between hover:bg-gray-50 p-2 rounded">
          <div class="flex items-center gap-4 flex-1">
            <span class="text-2xl">ğŸ“</span>
            <div class="flex-1">
              <p class="font-semibold text-gray-900">{{ retiro.destino }}</p>
              <p class="text-sm text-gray-500">ğŸšš {{ retiro.encomendista }} â€¢ ğŸ• {{ retiro.hora }}</p>
            </div>
            <span class="bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full">{{ retiro.cantidad }} paq</span>
          </div>
          <svg class="w-5 h-5 transition" [ngClass]="{'rotate-180': retiro.expanded}">
            <path stroke="currentColor" stroke-width="2" fill="none" d="M19 9l-7 7-7-7"/>
          </svg>
        </div>
        <div *ngIf="retiro.expanded" class="ml-12 mt-4 space-y-2">
          <div *ngFor="let pedido of retiro.pedidos" class="bg-gray-50 p-3 rounded text-sm">
            <p class="font-medium text-gray-900">{{ pedido.id }}</p>
            <p class="text-gray-600">ğŸ‘¤ {{ pedido.cliente }}</p>
            <p class="text-gray-600">ğŸ“¦ {{ pedido.items }}</p>
            <div class="mt-2 flex items-center justify-between">
              <span>{{ formatCurrency(pedido.monto) }}</span>
              <span [ngClass]="getEstadoBadgeColor(pedido.estado)" class="text-xs px-2 py-1 rounded">
                {{ pedido.estado }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Retiros de Manana -->
  <div class="bg-white rounded-lg shadow">
    <div class="p-6 border-b border-gray-200">
      <h2 class="text-xl font-bold text-gray-900">Retiros de Manana</h2>
      <p class="text-sm text-gray-500 mt-1">{{ retiroTomorrow.length }} rutas programadas</p>
    </div>
    <div class="divide-y">
      <div *ngFor="let retiro of retiroTomorrow; let i = index" class="p-4">
        <div (click)="toggleRetiroTomorrow(i)" class="cursor-pointer flex items-center justify-between hover:bg-gray-50 p-2 rounded">
          <div class="flex items-center gap-4 flex-1">
            <span class="text-2xl">ğŸ“</span>
            <div class="flex-1">
              <p class="font-semibold text-gray-900">{{ retiro.destino }}</p>
              <p class="text-sm text-gray-500">ğŸšš {{ retiro.encomendista }} â€¢ ğŸ• {{ retiro.hora }}</p>
            </div>
            <span class="bg-yellow-100 text-yellow-800 text-sm font-medium px-3 py-1 rounded-full">{{ retiro.cantidad }} paq</span>
          </div>
          <svg class="w-5 h-5 transition" [ngClass]="{'rotate-180': retiro.expanded}">
            <path stroke="currentColor" stroke-width="2" fill="none" d="M19 9l-7 7-7-7"/>
          </svg>
        </div>
        <div *ngIf="retiro.expanded" class="ml-12 mt-4 space-y-2">
          <div *ngFor="let pedido of retiro.pedidos" class="bg-gray-50 p-3 rounded text-sm">
            <p class="font-medium text-gray-900">{{ pedido.id }}</p>
            <p class="text-gray-600">ğŸ‘¤ {{ pedido.cliente }}</p>
            <p class="text-gray-600">ğŸ“¦ {{ pedido.items }}</p>
            <div class="mt-2 flex items-center justify-between">
              <span class="text-green-600 font-semibold">${{ (pedido.monto || 0).toLocaleString('es-CL') }}</span>
              <span [ngClass]="getEstadoBadgeColor(pedido.estado)" class="px-2 py-0.5 rounded text-xs font-medium">
                {{ pedido.estado }}
              </span>
            </div>
          </div>
        </div>
    </div>
  </div>

  <!-- Pedidos Pendientes -->
  <div class="bg-white rounded-lg shadow">
    <div class="p-6 border-b border-gray-200">
      <h2 class="text-xl font-bold text-gray-900">Pedidos Pendientes de Retirar</h2>
      <p class="text-sm text-gray-500 mt-1">Ordenes que no han sido retiradas</p>
    </div>
    <div class="overflow-x-auto">
      <table class="w-full">
        <thead class="bg-gray-50 border-b">
          <tr>
            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-900">ID Pedido</th>
            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-900">Cliente</th>
            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-900">Destino</th>
            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-900">Dias sin Retirar</th>
            <th class="px-6 py-3 text-right text-sm font-semibold text-gray-900">Monto</th>
          </tr>
        </thead>
        <tbody class="divide-y">
          <tr *ngFor="let pedido of pedidosNoRetirados" class="hover:bg-gray-50">
            <td class="px-6 py-4 text-sm font-medium text-gray-900">{{ pedido.id }}</td>
            <td class="px-6 py-4 text-sm text-gray-600">{{ pedido.cliente }}</td>
            <td class="px-6 py-4 text-sm text-gray-600">{{ pedido.destino }}</td>
            <td class="px-6 py-4 text-sm">
              <span [ngClass]="getDiasSinRetirarColor(pedido.diasSinRetirar)" class="font-semibold">
                {{ pedido.diasSinRetirar }} dias
              </span>
            </td>
            <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">{{ formatCurrency(pedido.monto) }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
</div>

<!-- VISTA MOBILE -->
<div *ngIf="isMobile" class="space-y-4 p-3">
  <!-- Header Mobile -->
  <div class="mb-4">
    <h1 class="text-2xl font-bold text-gray-900">Dashboard</h1>
    <p class="text-xs text-gray-500 mt-1">Estado del sistema</p>
  </div>

  <!-- EstadÃ­sticas Compactas (2x5 grid) -->
  <div class="grid grid-cols-2 gap-2">
    <!-- Pedidos Hoy -->
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
      <p class="text-xs text-blue-700 font-medium">Hoy</p>
      <p class="text-2xl font-bold text-blue-900">{{ stats.pedidosHoy }}</p>
      <p class="text-xs text-blue-600 mt-1">ğŸ“¦ pedidos</p>
    </div>

    <!-- Pedidos MaÃ±ana -->
    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
      <p class="text-xs text-yellow-700 font-medium">MaÃ±ana</p>
      <p class="text-2xl font-bold text-yellow-900">{{ stats.pedidosTomorrow }}</p>
      <p class="text-xs text-yellow-600 mt-1">ğŸ“… pedidos</p>
    </div>

    <!-- Ingresos Hoy -->
    <div class="bg-green-50 border border-green-200 rounded-lg p-3">
      <p class="text-xs text-green-700 font-medium">Hoy</p>
      <p class="text-xl font-bold text-green-900">{{ formatCurrency(stats.ingresoHoy) }}</p>
      <p class="text-xs text-green-600 mt-1">ğŸ’° ingresos</p>
    </div>

    <!-- Ingresos Mes -->
    <div class="bg-purple-50 border border-purple-200 rounded-lg p-3">
      <p class="text-xs text-purple-700 font-medium">Mes</p>
      <p class="text-xl font-bold text-purple-900">{{ formatCurrency(stats.ingresoMes) }}</p>
      <p class="text-xs text-purple-600 mt-1">ğŸ“ˆ totales</p>
    </div>

    <!-- Pendientes -->
    <div class="bg-red-50 border border-red-200 rounded-lg p-3">
      <p class="text-xs text-red-700 font-medium">Pendientes</p>
      <p class="text-2xl font-bold text-red-900">{{ stats.pedidosNoRetirados }}</p>
      <p class="text-xs text-red-600 mt-1">âš ï¸ sin retirar</p>
    </div>

    <!-- Tasa Entrega -->
    <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-3">
      <p class="text-xs text-indigo-700 font-medium">Efectividad</p>
      <p class="text-2xl font-bold text-indigo-900">{{ stats.tasaEntrega }}%</p>
      <p class="text-xs text-indigo-600 mt-1">âœ… entregas</p>
    </div>
  </div>

  <!-- Retiros de Hoy (Comprimido) -->
  <div class="bg-white rounded-lg shadow border-l-4 border-blue-500">
    <div class="p-3 border-b border-gray-200">
      <h3 class="font-bold text-gray-900 text-sm">Retiros Hoy</h3>
      <p class="text-xs text-gray-500 mt-0.5">{{ retiroHoy.length }} rutas</p>
    </div>
    <div class="divide-y text-sm max-h-40 overflow-y-auto">
      <div *ngFor="let retiro of retiroHoy.slice(0, 3)" class="p-3">
        <div class="flex items-start justify-between gap-2">
          <div class="flex-1">
            <p class="font-semibold text-gray-900">{{ retiro.destino }}</p>
            <p class="text-xs text-gray-600">{{ retiro.encomendista }}</p>
          </div>
          <span class="bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded">{{ retiro.cantidad }}</span>
        </div>
      </div>
      <div *ngIf="retiroHoy.length > 3" class="p-3 text-center text-xs text-gray-500">
        +{{ retiroHoy.length - 3 }} mÃ¡s...
      </div>
    </div>
  </div>

  <!-- Retiros de MaÃ±ana (Comprimido) -->
  <div class="bg-white rounded-lg shadow border-l-4 border-yellow-500">
    <div class="p-3 border-b border-gray-200">
      <h3 class="font-bold text-gray-900 text-sm">Retiros MaÃ±ana</h3>
      <p class="text-xs text-gray-500 mt-0.5">{{ retiroTomorrow.length }} rutas</p>
    </div>
    <div class="divide-y text-sm max-h-40 overflow-y-auto">
      <div *ngFor="let retiro of retiroTomorrow.slice(0, 3)" class="p-3">
        <div class="flex items-start justify-between gap-2">
          <div class="flex-1">
            <p class="font-semibold text-gray-900">{{ retiro.destino }}</p>
            <p class="text-xs text-gray-600">{{ retiro.encomendista }}</p>
          </div>
          <span class="bg-yellow-100 text-yellow-800 text-xs font-bold px-2 py-1 rounded">{{ retiro.cantidad }}</span>
        </div>
      </div>
      <div *ngIf="retiroTomorrow.length > 3" class="p-3 text-center text-xs text-gray-500">
        +{{ retiroTomorrow.length - 3 }} mÃ¡s...
      </div>
    </div>
  </div>

  <!-- Pendientes (Tabla Simplificada) -->
  <div class="bg-white rounded-lg shadow">
    <div class="p-3 border-b border-gray-200">
      <h3 class="font-bold text-gray-900 text-sm">Pendientes Retirar</h3>
      <p class="text-xs text-gray-500 mt-0.5">{{ pedidosNoRetirados.length }} pedidos</p>
    </div>
    <div class="divide-y text-sm max-h-48 overflow-y-auto">
      <div *ngFor="let pedido of pedidosNoRetirados.slice(0, 5)" class="p-3">
        <div class="flex items-start justify-between gap-2">
          <div class="flex-1">
            <p class="font-semibold text-gray-900 text-xs">{{ pedido.id }}</p>
            <p class="text-xs text-gray-600">ğŸ‘¤ {{ pedido.cliente }}</p>
            <p class="text-xs text-gray-500">ğŸ“ {{ pedido.destino }}</p>
          </div>
          <span class="bg-red-100 text-red-700 text-xs font-bold px-2 py-0.5 rounded">{{ pedido.diasSinRetirar }}d</span>
        </div>
        <p class="text-xs text-gray-700 font-medium mt-1">{{ formatCurrency(pedido.monto) }}</p>
      </div>
      <div *ngIf="pedidosNoRetirados.length > 5" class="p-3 text-center text-xs text-gray-500">
        +{{ pedidosNoRetirados.length - 5 }} mÃ¡s...
      </div>
    </div>
  </div>
</div>
